{"ast":null,"code":"import _classCallCheck from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _objectWithoutProperties from \"/home/emmanuel/Documents/frt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/home/emmanuel/Documents/frt/src/containers/App/index.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport URLSearchParams from 'url-search-params';\nimport { Redirect, Route, Switch } from \"react-router-dom\";\nimport { LocaleProvider } from \"antd\";\nimport { IntlProvider } from \"react-intl\";\nimport AppLocale from \"lngProvider\";\nimport MainApp from \"./MainApp\";\nimport SignIn from \"../SignIn\";\nimport SignUp from \"../SignUp\";\nimport { setInitUrl } from \"appRedux/actions/Auth\";\nimport { onLayoutTypeChange, onNavStyleChange, setThemeType } from \"appRedux/actions/Setting\";\nimport axios from 'util/Api';\nimport { LAYOUT_TYPE_BOXED, LAYOUT_TYPE_FRAMED, LAYOUT_TYPE_FULL, NAV_STYLE_ABOVE_HEADER, NAV_STYLE_BELOW_HEADER, NAV_STYLE_DARK_HORIZONTAL, NAV_STYLE_DEFAULT_HORIZONTAL, NAV_STYLE_INSIDE_HEADER_HORIZONTAL, THEME_TYPE_DARK } from \"../../constants/ThemeSetting\";\nimport { getUser } from \"../../appRedux/actions/Auth\";\n\nvar RestrictedRoute = function RestrictedRoute(_ref) {\n  var Component = _ref.component,\n      token = _ref.token,\n      rest = _objectWithoutProperties(_ref, [\"component\", \"token\"]);\n\n  return React.createElement(Route, Object.assign({}, rest, {\n    render: function render(props) {\n      return token ? React.createElement(Component, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      })) : React.createElement(Redirect, {\n        to: {\n          pathname: '/signin',\n          state: {\n            from: props.location\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }));\n};\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.setLayoutType = function (layoutType) {\n      if (layoutType === LAYOUT_TYPE_FULL) {\n        document.body.classList.remove('boxed-layout');\n        document.body.classList.remove('framed-layout');\n        document.body.classList.add('full-layout');\n      } else if (layoutType === LAYOUT_TYPE_BOXED) {\n        document.body.classList.remove('full-layout');\n        document.body.classList.remove('framed-layout');\n        document.body.classList.add('boxed-layout');\n      } else if (layoutType === LAYOUT_TYPE_FRAMED) {\n        document.body.classList.remove('boxed-layout');\n        document.body.classList.remove('full-layout');\n        document.body.classList.add('framed-layout');\n      }\n    };\n\n    _this.setNavStyle = function (navStyle) {\n      if (navStyle === NAV_STYLE_DEFAULT_HORIZONTAL || navStyle === NAV_STYLE_DARK_HORIZONTAL || navStyle === NAV_STYLE_INSIDE_HEADER_HORIZONTAL || navStyle === NAV_STYLE_ABOVE_HEADER || navStyle === NAV_STYLE_BELOW_HEADER) {\n        document.body.classList.add('full-scroll');\n        document.body.classList.add('horizontal-layout');\n      } else {\n        document.body.classList.remove('full-scroll');\n        document.body.classList.remove('horizontal-layout');\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      if (this.props.initURL === '') {\n        this.props.setInitUrl(this.props.history.location.pathname);\n      }\n\n      var params = new URLSearchParams(this.props.location.search);\n\n      if (params.has(\"theme\")) {\n        this.props.setThemeType(params.get('theme'));\n      }\n\n      if (params.has(\"nav-style\")) {\n        this.props.onNavStyleChange(params.get('nav-style'));\n      }\n\n      if (params.has(\"layout-type\")) {\n        this.props.onLayoutTypeChange(params.get('layout-type'));\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.token) {\n        axios.defaults.headers.common['Authorization'] = \"Bearer \" + nextProps.token;\n      }\n\n      if (nextProps.token && !nextProps.authUser) {\n        this.props.getUser();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          match = _this$props.match,\n          location = _this$props.location,\n          themeType = _this$props.themeType,\n          layoutType = _this$props.layoutType,\n          navStyle = _this$props.navStyle,\n          locale = _this$props.locale,\n          token = _this$props.token,\n          initURL = _this$props.initURL;\n\n      if (themeType === THEME_TYPE_DARK) {\n        document.body.classList.add('dark-theme');\n      }\n\n      if (location.pathname === '/') {\n        if (token === null) {\n          return React.createElement(Redirect, {\n            to: '/signin',\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 109\n            },\n            __self: this\n          });\n        } else if (initURL === '' || initURL === '/' || initURL === '/signin') {\n          return React.createElement(Redirect, {\n            to: '/home',\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111\n            },\n            __self: this\n          });\n        } else {\n          return React.createElement(Redirect, {\n            to: initURL,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113\n            },\n            __self: this\n          });\n        }\n      }\n\n      this.setLayoutType(layoutType);\n      this.setNavStyle(navStyle);\n      var currentAppLocale = AppLocale[locale.locale];\n      return React.createElement(LocaleProvider, {\n        locale: currentAppLocale.antd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(IntlProvider, {\n        locale: currentAppLocale.locale,\n        messages: currentAppLocale.messages,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/signin\",\n        component: SignIn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/signup\",\n        component: SignUp,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), React.createElement(RestrictedRoute, {\n        path: \"\".concat(match.url),\n        token: token,\n        component: MainApp,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(_ref2) {\n  var settings = _ref2.settings,\n      auth = _ref2.auth;\n  var locale = settings.locale,\n      navStyle = settings.navStyle,\n      themeType = settings.themeType,\n      layoutType = settings.layoutType;\n  var authUser = auth.authUser,\n      token = auth.token,\n      initURL = auth.initURL;\n  return {\n    locale: locale,\n    token: token,\n    navStyle: navStyle,\n    themeType: themeType,\n    layoutType: layoutType,\n    authUser: authUser,\n    initURL: initURL\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setInitUrl: setInitUrl,\n  getUser: getUser,\n  setThemeType: setThemeType,\n  onNavStyleChange: onNavStyleChange,\n  onLayoutTypeChange: onLayoutTypeChange\n})(App);","map":{"version":3,"sources":["/home/emmanuel/Documents/frt/src/containers/App/index.js"],"names":["React","Component","connect","URLSearchParams","Redirect","Route","Switch","LocaleProvider","IntlProvider","AppLocale","MainApp","SignIn","SignUp","setInitUrl","onLayoutTypeChange","onNavStyleChange","setThemeType","axios","LAYOUT_TYPE_BOXED","LAYOUT_TYPE_FRAMED","LAYOUT_TYPE_FULL","NAV_STYLE_ABOVE_HEADER","NAV_STYLE_BELOW_HEADER","NAV_STYLE_DARK_HORIZONTAL","NAV_STYLE_DEFAULT_HORIZONTAL","NAV_STYLE_INSIDE_HEADER_HORIZONTAL","THEME_TYPE_DARK","getUser","RestrictedRoute","component","token","rest","props","pathname","state","from","location","App","setLayoutType","layoutType","document","body","classList","remove","add","setNavStyle","navStyle","initURL","history","params","search","has","get","nextProps","defaults","headers","common","authUser","match","themeType","locale","currentAppLocale","antd","messages","url","mapStateToProps","settings","auth"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,SAAQC,QAAR,EAAkBC,KAAlB,EAAyBC,MAAzB,QAAsC,kBAAtC;AACA,SAAQC,cAAR,QAA6B,MAA7B;AACA,SAAQC,YAAR,QAA2B,YAA3B;AAEA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAAQC,UAAR,QAAyB,uBAAzB;AACA,SAAQC,kBAAR,EAA4BC,gBAA5B,EAA8CC,YAA9C,QAAiE,0BAAjE;AACA,OAAOC,KAAP,MAAkB,UAAlB;AAEA,SACEC,iBADF,EAEEC,kBAFF,EAGEC,gBAHF,EAIEC,sBAJF,EAKEC,sBALF,EAMEC,yBANF,EAOEC,4BAPF,EAQEC,kCARF,EASEC,eATF,QAUO,8BAVP;AAWA,SAAQC,OAAR,QAAsB,6BAAtB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB;AAAA,MAAa3B,SAAb,QAAE4B,SAAF;AAAA,MAAwBC,KAAxB,QAAwBA,KAAxB;AAAA,MAAkCC,IAAlC;;AAAA,SACtB,oBAAC,KAAD,oBACMA,IADN;AAEE,IAAA,MAAM,EAAE,gBAAAC,KAAK;AAAA,aACXF,KAAK,GACD,oBAAC,SAAD,oBAAeE,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADC,GAED,oBAAC,QAAD;AACA,QAAA,EAAE,EAAE;AACFC,UAAAA,QAAQ,EAAE,SADR;AAEFC,UAAAA,KAAK,EAAE;AAACC,YAAAA,IAAI,EAAEH,KAAK,CAACI;AAAb;AAFL,SADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHO;AAAA,KAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADsB;AAAA,CAAxB;;IAeMC,G;;;;;;;;;;;;;;;;;;UAEJC,a,GAAgB,UAACC,UAAD,EAAgB;AAC9B,UAAIA,UAAU,KAAKnB,gBAAnB,EAAqC;AACnCoB,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,cAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,eAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,aAA5B;AACD,OAJD,MAIO,IAAIL,UAAU,KAAKrB,iBAAnB,EAAsC;AAC3CsB,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,aAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,eAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,cAA5B;AACD,OAJM,MAIA,IAAIL,UAAU,KAAKpB,kBAAnB,EAAuC;AAC5CqB,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,cAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,aAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,eAA5B;AACD;AACF,K;;UAEDC,W,GAAc,UAACC,QAAD,EAAc;AAC1B,UAAIA,QAAQ,KAAKtB,4BAAb,IACFsB,QAAQ,KAAKvB,yBADX,IAEFuB,QAAQ,KAAKrB,kCAFX,IAGFqB,QAAQ,KAAKzB,sBAHX,IAIFyB,QAAQ,KAAKxB,sBAJf,EAIuC;AACrCkB,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,aAA5B;AACAJ,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,mBAA5B;AACD,OAPD,MAOO;AACLJ,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,aAA/B;AACAH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,mBAA/B;AACD;AACF,K;;;;;;;yCAEoB;AACnB,UAAI,KAAKX,KAAL,CAAWe,OAAX,KAAuB,EAA3B,EAA+B;AAC7B,aAAKf,KAAL,CAAWnB,UAAX,CAAsB,KAAKmB,KAAL,CAAWgB,OAAX,CAAmBZ,QAAnB,CAA4BH,QAAlD;AACD;;AACD,UAAMgB,MAAM,GAAG,IAAI9C,eAAJ,CAAoB,KAAK6B,KAAL,CAAWI,QAAX,CAAoBc,MAAxC,CAAf;;AACA,UAAID,MAAM,CAACE,GAAP,CAAW,OAAX,CAAJ,EAAyB;AACvB,aAAKnB,KAAL,CAAWhB,YAAX,CAAwBiC,MAAM,CAACG,GAAP,CAAW,OAAX,CAAxB;AACD;;AACD,UAAIH,MAAM,CAACE,GAAP,CAAW,WAAX,CAAJ,EAA6B;AAC3B,aAAKnB,KAAL,CAAWjB,gBAAX,CAA4BkC,MAAM,CAACG,GAAP,CAAW,WAAX,CAA5B;AACD;;AACD,UAAIH,MAAM,CAACE,GAAP,CAAW,aAAX,CAAJ,EAA+B;AAC7B,aAAKnB,KAAL,CAAWlB,kBAAX,CAA8BmC,MAAM,CAACG,GAAP,CAAW,aAAX,CAA9B;AACD;AACF;;;8CAEyBC,S,EAAW;AACnC,UAAIA,SAAS,CAACvB,KAAd,EAAqB;AACnBb,QAAAA,KAAK,CAACqC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiD,YAAYH,SAAS,CAACvB,KAAvE;AACD;;AACD,UAAIuB,SAAS,CAACvB,KAAV,IAAmB,CAACuB,SAAS,CAACI,QAAlC,EAA4C;AAC1C,aAAKzB,KAAL,CAAWL,OAAX;AAED;AACF;;;6BAEQ;AAAA,wBAC4E,KAAKK,KADjF;AAAA,UACA0B,KADA,eACAA,KADA;AAAA,UACOtB,QADP,eACOA,QADP;AAAA,UACiBuB,SADjB,eACiBA,SADjB;AAAA,UAC4BpB,UAD5B,eAC4BA,UAD5B;AAAA,UACwCO,QADxC,eACwCA,QADxC;AAAA,UACkDc,MADlD,eACkDA,MADlD;AAAA,UAC0D9B,KAD1D,eAC0DA,KAD1D;AAAA,UACiEiB,OADjE,eACiEA,OADjE;;AAEP,UAAIY,SAAS,KAAKjC,eAAlB,EAAmC;AACjCc,QAAAA,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4B,YAA5B;AACD;;AACD,UAAIR,QAAQ,CAACH,QAAT,KAAsB,GAA1B,EAA+B;AAC7B,YAAIH,KAAK,KAAK,IAAd,EAAoB;AAClB,iBAAS,oBAAC,QAAD;AAAU,YAAA,EAAE,EAAE,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAT;AACD,SAFD,MAEO,IAAIiB,OAAO,KAAK,EAAZ,IAAkBA,OAAO,KAAK,GAA9B,IAAqCA,OAAO,KAAK,SAArD,EAAgE;AACrE,iBAAS,oBAAC,QAAD;AAAU,YAAA,EAAE,EAAE,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAT;AACD,SAFM,MAEA;AACL,iBAAS,oBAAC,QAAD;AAAU,YAAA,EAAE,EAAEA,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAT;AACD;AACF;;AACD,WAAKT,aAAL,CAAmBC,UAAnB;AAEA,WAAKM,WAAL,CAAiBC,QAAjB;AAEA,UAAMe,gBAAgB,GAAGpD,SAAS,CAACmD,MAAM,CAACA,MAAR,CAAlC;AACA,aACE,oBAAC,cAAD;AAAgB,QAAA,MAAM,EAAEC,gBAAgB,CAACC,IAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,YAAD;AACE,QAAA,MAAM,EAAED,gBAAgB,CAACD,MAD3B;AAEE,QAAA,QAAQ,EAAEC,gBAAgB,CAACE,QAF7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD;AAAO,QAAA,KAAK,MAAZ;AAAa,QAAA,IAAI,EAAC,SAAlB;AAA4B,QAAA,SAAS,EAAEpD,MAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,KAAD;AAAO,QAAA,KAAK,MAAZ;AAAa,QAAA,IAAI,EAAC,SAAlB;AAA4B,QAAA,SAAS,EAAEC,MAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAGE,oBAAC,eAAD;AAAiB,QAAA,IAAI,YAAK8C,KAAK,CAACM,GAAX,CAArB;AAAuC,QAAA,KAAK,EAAElC,KAA9C;AACiB,QAAA,SAAS,EAAEpB,OAD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,CAJF,CADF,CADF;AAeD;;;;EA5FeT,S;;AA+FlB,IAAMgE,eAAe,GAAG,SAAlBA,eAAkB,QAAsB;AAAA,MAApBC,QAAoB,SAApBA,QAAoB;AAAA,MAAVC,IAAU,SAAVA,IAAU;AAAA,MACrCP,MADqC,GACMM,QADN,CACrCN,MADqC;AAAA,MAC7Bd,QAD6B,GACMoB,QADN,CAC7BpB,QAD6B;AAAA,MACnBa,SADmB,GACMO,QADN,CACnBP,SADmB;AAAA,MACRpB,UADQ,GACM2B,QADN,CACR3B,UADQ;AAAA,MAErCkB,QAFqC,GAETU,IAFS,CAErCV,QAFqC;AAAA,MAE3B3B,KAF2B,GAETqC,IAFS,CAE3BrC,KAF2B;AAAA,MAEpBiB,OAFoB,GAEToB,IAFS,CAEpBpB,OAFoB;AAG5C,SAAO;AAACa,IAAAA,MAAM,EAANA,MAAD;AAAS9B,IAAAA,KAAK,EAALA,KAAT;AAAgBgB,IAAAA,QAAQ,EAARA,QAAhB;AAA0Ba,IAAAA,SAAS,EAATA,SAA1B;AAAqCpB,IAAAA,UAAU,EAAVA,UAArC;AAAiDkB,IAAAA,QAAQ,EAARA,QAAjD;AAA2DV,IAAAA,OAAO,EAAPA;AAA3D,GAAP;AACD,CAJD;;AAKA,eAAe7C,OAAO,CAAC+D,eAAD,EAAkB;AAACpD,EAAAA,UAAU,EAAVA,UAAD;AAAac,EAAAA,OAAO,EAAPA,OAAb;AAAsBX,EAAAA,YAAY,EAAZA,YAAtB;AAAoCD,EAAAA,gBAAgB,EAAhBA,gBAApC;AAAsDD,EAAAA,kBAAkB,EAAlBA;AAAtD,CAAlB,CAAP,CAAoGuB,GAApG,CAAf","sourcesContent":["import React, {Component} from \"react\";\nimport {connect} from \"react-redux\";\nimport URLSearchParams from 'url-search-params'\nimport {Redirect, Route, Switch} from \"react-router-dom\";\nimport {LocaleProvider} from \"antd\";\nimport {IntlProvider} from \"react-intl\";\n\nimport AppLocale from \"lngProvider\";\nimport MainApp from \"./MainApp\";\nimport SignIn from \"../SignIn\";\nimport SignUp from \"../SignUp\";\nimport {setInitUrl} from \"appRedux/actions/Auth\";\nimport {onLayoutTypeChange, onNavStyleChange, setThemeType} from \"appRedux/actions/Setting\";\nimport axios from 'util/Api';\n\nimport {\n  LAYOUT_TYPE_BOXED,\n  LAYOUT_TYPE_FRAMED,\n  LAYOUT_TYPE_FULL,\n  NAV_STYLE_ABOVE_HEADER,\n  NAV_STYLE_BELOW_HEADER,\n  NAV_STYLE_DARK_HORIZONTAL,\n  NAV_STYLE_DEFAULT_HORIZONTAL,\n  NAV_STYLE_INSIDE_HEADER_HORIZONTAL,\n  THEME_TYPE_DARK\n} from \"../../constants/ThemeSetting\";\nimport {getUser} from \"../../appRedux/actions/Auth\";\n\nconst RestrictedRoute = ({component: Component, token, ...rest}) =>\n  <Route\n    {...rest}\n    render={props =>\n      token\n        ? <Component {...props} />\n        : <Redirect\n          to={{\n            pathname: '/signin',\n            state: {from: props.location}\n          }}\n        />}\n  />;\n\n\nclass App extends Component {\n\n  setLayoutType = (layoutType) => {\n    if (layoutType === LAYOUT_TYPE_FULL) {\n      document.body.classList.remove('boxed-layout');\n      document.body.classList.remove('framed-layout');\n      document.body.classList.add('full-layout');\n    } else if (layoutType === LAYOUT_TYPE_BOXED) {\n      document.body.classList.remove('full-layout');\n      document.body.classList.remove('framed-layout');\n      document.body.classList.add('boxed-layout');\n    } else if (layoutType === LAYOUT_TYPE_FRAMED) {\n      document.body.classList.remove('boxed-layout');\n      document.body.classList.remove('full-layout');\n      document.body.classList.add('framed-layout');\n    }\n  };\n\n  setNavStyle = (navStyle) => {\n    if (navStyle === NAV_STYLE_DEFAULT_HORIZONTAL ||\n      navStyle === NAV_STYLE_DARK_HORIZONTAL ||\n      navStyle === NAV_STYLE_INSIDE_HEADER_HORIZONTAL ||\n      navStyle === NAV_STYLE_ABOVE_HEADER ||\n      navStyle === NAV_STYLE_BELOW_HEADER) {\n      document.body.classList.add('full-scroll');\n      document.body.classList.add('horizontal-layout');\n    } else {\n      document.body.classList.remove('full-scroll');\n      document.body.classList.remove('horizontal-layout');\n    }\n  };\n\n  componentWillMount() {\n    if (this.props.initURL === '') {\n      this.props.setInitUrl(this.props.history.location.pathname);\n    }\n    const params = new URLSearchParams(this.props.location.search);\n    if (params.has(\"theme\")) {\n      this.props.setThemeType(params.get('theme'));\n    }\n    if (params.has(\"nav-style\")) {\n      this.props.onNavStyleChange(params.get('nav-style'));\n    }\n    if (params.has(\"layout-type\")) {\n      this.props.onLayoutTypeChange(params.get('layout-type'));\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.token) {\n      axios.defaults.headers.common['Authorization'] = \"Bearer \" + nextProps.token;\n    }\n    if (nextProps.token && !nextProps.authUser) {\n      this.props.getUser()\n\n    }\n  }\n\n  render() {\n    const {match, location, themeType, layoutType, navStyle, locale, token, initURL} = this.props;\n    if (themeType === THEME_TYPE_DARK) {\n      document.body.classList.add('dark-theme');\n    }\n    if (location.pathname === '/') {\n      if (token === null) {\n        return ( <Redirect to={'/signin'}/> );\n      } else if (initURL === '' || initURL === '/' || initURL === '/signin') {\n        return ( <Redirect to={'/home'}/> );\n      } else {\n        return ( <Redirect to={initURL}/> );\n      }\n    }\n    this.setLayoutType(layoutType);\n\n    this.setNavStyle(navStyle);\n\n    const currentAppLocale = AppLocale[locale.locale];\n    return (\n      <LocaleProvider locale={currentAppLocale.antd}>\n        <IntlProvider\n          locale={currentAppLocale.locale}\n          messages={currentAppLocale.messages}>\n\n          <Switch>\n            <Route exact path='/signin' component={SignIn}/>\n            <Route exact path='/signup' component={SignUp}/>\n            <RestrictedRoute path={`${match.url}`} token={token}\n                             component={MainApp}/>\n          </Switch>\n        </IntlProvider>\n      </LocaleProvider>\n    )\n  }\n}\n\nconst mapStateToProps = ({settings, auth}) => {\n  const {locale, navStyle, themeType, layoutType} = settings;\n  const {authUser, token, initURL} = auth;\n  return {locale, token, navStyle, themeType, layoutType, authUser, initURL}\n};\nexport default connect(mapStateToProps, {setInitUrl, getUser, setThemeType, onNavStyleChange, onLayoutTypeChange})(App);\n"]},"metadata":{},"sourceType":"module"}